{% extends 'base.html' %} {% block content %}
<section>
  <h1>Orders</h1>
  {% if orders %}
  <table>
    <thead>
      <tr>
        <th>Order ID</th>
        <th>Customer</th>
        <th>Date</th>
        <th>Status</th>
        <th>Items</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for order in orders %}
      <tr>
        <td>{{ order.id }}</td>
        <td>{{ order.User.username }}</td>
        <td>{{ order.OrderDate }}</td>
        <td>
          {% if order.fulfillmentstatus_set.first %} {{
          order.fulfillmentstatus_set.first.get_OrderStatus_display }} {% else
          %} N/A {% endif %}
        </td>
        <td>
          <ul>
            {% for item in order.orderitems_set.all %}
            <li>
              {{ item.Model.Name }} - Qty: {{ item.ItemQuantity }} {% if
              item.InventoryChange %} - Material: {{
              item.InventoryChange.RawMaterial.Filament.Material.Name }} {%
              endif %}
            </li>
            {% empty %}
            <li>No items</li>
            {% endfor %}
          </ul>
        </td>
        <td>
          <a href="{% url 'edit-order' order.id %}">Edit</a>
          <a href="{% url 'delete-order' order.id %}">Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>No orders found.</p>
  {% endif %}

  <a href="{% url 'add-order' %}">Add New Order</a>
</section>
{% endblock %}
